{"version":3,"sources":["gpu/gpu.ts","gpu/module.ts","helper/file.ts","gpu/lines.ts","gpu/math.ts","gpu/position.ts","gpu/camera.ts","loader/cube.ts","gpu/cloud.ts","gpu/kNearest.ts","gpu/triangulate.ts","gpu/filter.ts","gpu/edge.ts","gpu/edgeOld.ts","loader/color.ts","loader/grid.ts","loader/sphere.ts","loader/decompress.ts","loader/pcd.ts","main.ts"],"names":[],"mappings":"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","file":"main.8db78169.js","sourceRoot":"..\\src","sourcesContent":["import { Camera } from './camera'\n\nexport let adapter: GPUAdapter\nexport let device: GPUDevice\n\nexport const clearColor = { r: 0.0, g: 0.1, b: 0.2, a: 1.0 }\nexport let format: GPUTextureFormat\nexport let sampler: GPUSampler\n\nexport let canvas: HTMLCanvasElement\nexport let context: GPUCanvasContext\n\nexport let global: {\n\taspect: number\n}\n\nexport let depth: GPUTexture\n\nexport async function Setup(width: number, height: number): Promise<HTMLCanvasElement | undefined> {\n\tif (window.navigator.gpu == undefined) {\n\t\treturn undefined\n\t}\n\tadapter = (await window.navigator.gpu.requestAdapter({\n\t\tpowerPreference: 'high-performance',\n\t})) as GPUAdapter\n\tdevice = (await adapter.requestDevice()) as GPUDevice\n\tdevice.lost.then((info) => {\n\t\tconsole.log(info)\n\t})\n\n\tcanvas = document.createElement('canvas')\n\tcontext = canvas.getContext('webgpu') as GPUCanvasContext\n\n\tformat = context.getPreferredFormat(adapter)\n\n\tglobal = {\n\t\taspect: undefined as any,\n\t}\n\n\tsampler = device.createSampler({\n\t\tmagFilter: 'linear',\n\t\tminFilter: 'linear',\n\t})\n\n\tResize(width, height)\n\n\treturn canvas\n}\n\nexport function Resize(width: number, height: number): void {\n\tcontext.configure({\n\t\tdevice: device,\n\t\tformat: format,\n\t\tsize: { width: width, height: height },\n\t})\n\tcanvas.width = width\n\tcanvas.height = height\n\n\tdepth = device.createTexture({\n\t\tsize: {\n\t\t\twidth: canvas.width,\n\t\t\theight: canvas.height,\n\t\t},\n\t\tformat: 'depth32float',\n\t\tusage: GPUTextureUsage.RENDER_ATTACHMENT,\n\t})\n\tglobal.aspect = canvas.width / canvas.height\n}\n\nexport let cameraBuffer: GPUBuffer\nexport let renderPass: GPURenderPassEncoder\nlet encoder: GPUCommandEncoder\n\nexport function StartRender(camera: Camera): void {\n\tencoder = device.createCommandEncoder()\n\trenderPass = encoder.beginRenderPass({\n\t\tcolorAttachments: [\n\t\t\t{\n\t\t\t\tloadValue: clearColor,\n\t\t\t\tstoreOp: 'store',\n\t\t\t\tview: context.getCurrentTexture().createView(),\n\t\t\t},\n\t\t],\n\t\tdepthStencilAttachment: {\n\t\t\tdepthLoadValue: 1.0,\n\t\t\tdepthStoreOp: 'store',\n\t\t\tstencilLoadValue: 0,\n\t\t\tstencilStoreOp: 'store',\n\t\t\tview: depth.createView(),\n\t\t},\n\t})\n\tcameraBuffer = camera.Buffer()\n}\n\nexport function FinishRender(): void {\n\trenderPass.endPass()\n\tdevice.queue.submit([encoder.finish()])\n}\n\nexport function CreateBuffer(data: Float32Array | Uint32Array, usage: GPUFlagsConstant): GPUBuffer {\n\tconst buffer = device.createBuffer({\n\t\tsize: data.byteLength,\n\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.COPY_SRC | usage,\n\t\tmappedAtCreation: true,\n\t})\n\tnew Uint8Array(buffer.getMappedRange()).set(new Uint8Array(data.buffer))\n\tbuffer.unmap()\n\treturn buffer\n}\n\nexport function CreateEmptyBuffer(length: number, usage: GPUFlagsConstant): GPUBuffer {\n\tconst buffer = device.createBuffer({\n\t\tsize: length,\n\t\tusage: usage,\n\t\tmappedAtCreation: false,\n\t})\n\treturn buffer\n}\nexport async function ReadBuffer(buffer: GPUBuffer, size: number): Promise<ArrayBuffer> {\n\tconst temp = CreateEmptyBuffer(size, GPUBufferUsage.MAP_READ | GPUBufferUsage.COPY_DST)\n\t// Encode commands for copying buffer to buffer.\n\tconst copyEncoder = device.createCommandEncoder()\n\tcopyEncoder.copyBufferToBuffer(\n\t\tbuffer /* source buffer */,\n\t\t0 /* source offset */,\n\t\ttemp /* destination buffer */,\n\t\t0 /* destination offset */,\n\t\tsize /* size */,\n\t)\n\tconst copyCommands = copyEncoder.finish()\n\tdevice.queue.submit([copyCommands])\n\tawait temp.mapAsync(GPUMapMode.READ)\n\tconst copyArrayBuffer = temp.getMappedRange()\n\treturn copyArrayBuffer\n}\n","import * as GPU from './gpu'\n\nexport function New(src: string): GPUShaderModule {\n\tconst module = GPU.device.createShaderModule({\n\t\tcode: src,\n\t})\n\treturn module\n}\n","export async function GetUserFile(endings: string[]): Promise<File> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst input = document.createElement('input')\n\t\tinput.type = 'file'\n\t\tinput.accept = ''\n\t\tfor (let i = 0; i < endings.length; i++) {\n\t\t\tinput.accept += '.' + endings[i]\n\t\t\tif (i < endings.length - 1) {\n\t\t\t\tinput.accept += ','\n\t\t\t}\n\t\t}\n\t\tinput.onchange = async () => {\n\t\t\tconst files = input.files\n\t\t\tif (files == null || files.length == 0) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst file = files[0]\n\t\t\tconst sep = file.name.split('.')\n\t\t\tconst format = sep[sep.length - 1]\n\t\t\tif (endings.includes(format)) {\n\t\t\t\tresolve(file)\n\t\t\t} else {\n\t\t\t\treject('format \"' + format + '\" not supported')\n\t\t\t}\n\t\t}\n\t\tinput.click()\n\t})\n}\n\nexport async function GetServerFile(path: string): Promise<string> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst request = new XMLHttpRequest()\n\t\trequest.onreadystatechange = () => {\n\t\t\tif (request.readyState == 4 && request.status == 200) {\n\t\t\t\tresolve(request.responseText)\n\t\t\t}\n\t\t}\n\t\trequest.open('GET', path)\n\t\trequest.send()\n\t\tsetTimeout(reject, 1000, 'file timeout')\n\t})\n}\n","import * as GPU from './gpu'\nimport * as Module from './module'\nimport { GetServerFile } from '../helper/file'\nimport { Position } from './position'\n\nlet pipeline: GPURenderPipeline | undefined = undefined\n\nexport async function Render(\n\tposition: Position,\n\tlength: number,\n\tpositions: GPUBuffer,\n\tcolors: GPUBuffer,\n): Promise<void> {\n\tif (pipeline == undefined) {\n\t\tconst src = await GetServerFile('render/lines.wgsl')\n\t\tconst module = Module.New(src)\n\n\t\tpipeline = GPU.device.createRenderPipeline({\n\t\t\tvertex: {\n\t\t\t\tmodule: module,\n\t\t\t\tentryPoint: 'vertexMain',\n\t\t\t\tbuffers: [\n\t\t\t\t\t{\n\t\t\t\t\t\tattributes: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshaderLocation: 0,\n\t\t\t\t\t\t\t\toffset: 0 * 4,\n\t\t\t\t\t\t\t\tformat: 'float32x3',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tarrayStride: 4 * 4,\n\t\t\t\t\t\tstepMode: 'vertex',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tattributes: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshaderLocation: 1,\n\t\t\t\t\t\t\t\toffset: 0 * 4,\n\t\t\t\t\t\t\t\tformat: 'float32x3',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tarrayStride: 4 * 4,\n\t\t\t\t\t\tstepMode: 'vertex',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tfragment: {\n\t\t\t\tmodule: module,\n\t\t\t\tentryPoint: 'fragmentMain',\n\t\t\t\ttargets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tformat: GPU.format,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tdepthStencil: {\n\t\t\t\tformat: 'depth32float',\n\t\t\t\tdepthWriteEnabled: true,\n\t\t\t\tdepthCompare: 'less',\n\t\t\t},\n\t\t\tprimitive: {\n\t\t\t\ttopology: 'line-list',\n\t\t\t},\n\t\t})\n\t}\n\n\tconst array = new Float32Array(16)\n\tposition.Save(array, 0)\n\tconst buffer = GPU.CreateBuffer(array, GPUBufferUsage.UNIFORM)\n\tGPU.renderPass.setPipeline(pipeline)\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: pipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: GPU.cameraBuffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t],\n\t})\n\tGPU.renderPass.setBindGroup(0, group)\n\tGPU.renderPass.setVertexBuffer(0, positions)\n\tGPU.renderPass.setVertexBuffer(1, colors)\n\tGPU.renderPass.draw(length)\n}\n","export class Matrix {\n\tprivate data: Float32Array\n\n\tprivate constructor(data: Float32Array) {\n\t\tthis.data = data\n\t}\n\n\tstatic Identity(): Matrix {\n\t\treturn new Matrix(\n\t\t\tnew Float32Array([\n\t\t\t\t/*eslint-disable*/\n\t\t\t\t1, 0, 0, 0,\n\t\t\t\t0, 1, 0, 0,\n\t\t\t\t0, 0, 1, 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t\t/*eslint-enable*/\n\t\t\t]),\n\t\t)\n\t}\n\n\tSave(location: Float32Array, offset: number): void {\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\tlocation[offset + i * 4 + j] = this.data[i + j * 4]\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic Translate(x: number, y: number, z: number): Matrix {\n\t\treturn new Matrix(\n\t\t\tnew Float32Array([\n\t\t\t\t/*eslint-disable*/\n\t\t\t\t1, 0, 0, x,\n\t\t\t\t0, 1, 0, y,\n\t\t\t\t0, 0, 1, z,\n\t\t\t\t0, 0, 0, 1\n\t\t\t\t/*eslint-enable*/\n\t\t\t]),\n\t\t)\n\t}\n\n\tstatic RotateX(rad: number): Matrix {\n\t\treturn new Matrix(\n\t\t\tnew Float32Array([\n\t\t\t\t/*eslint-disable*/\n\t\t\t\t1, 0, 0, 0,\n\t\t\t\t0, Math.cos(rad), -Math.sin(rad), 0,\n\t\t\t\t0, Math.sin(rad), Math.cos(rad), 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t\t/*eslint-enable*/\n\t\t\t]),\n\t\t)\n\t}\n\n\tstatic Rotate(rad: number, axis: Vector): Matrix {\n\t\tconst sin = Math.sin(rad)\n\t\tconst cos = Math.cos(rad)\n\t\tconst cosN = 1 - cos\n\t\t//https://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle\n\t\treturn new Matrix(\n\t\t\tnew Float32Array([\n\t\t\t\t/*eslint-disable*/\n\t\t\t\taxis.x*axis.x*cosN + cos,\n\t\t\t\taxis.x*axis.y*cosN - axis.z*sin,\n\t\t\t\taxis.x*axis.z*cosN + axis.y*sin,\n\t\t\t\t0,\n\n\t\t\t\taxis.y*axis.x*cosN + axis.z*sin,\n\t\t\t\taxis.y*axis.y*cosN + cos,\n\t\t\t\taxis.y*axis.z*cosN - axis.x*sin,\n\t\t\t\t0,\n\n\t\t\t\taxis.z*axis.x*cosN - axis.y*sin,\n\t\t\t\taxis.z*axis.y*cosN + axis.x*sin,\n\t\t\t\taxis.z*axis.z*cosN + cos,\n\t\t\t\t0,\n\n\t\t\t\t0, 0, 0, 1,\n\t\t\t\t/*eslint-enable*/\n\t\t\t]),\n\t\t)\n\t}\n\n\tstatic RotateY(rad: number): Matrix {\n\t\treturn new Matrix(\n\t\t\tnew Float32Array([\n\t\t\t\t/*eslint-disable*/\n\t\t\t\tMath.cos(rad), 0, Math.sin(rad), 0,\n\t\t\t\t0, 1, 0, 0,\n\t\t\t\t-Math.sin(rad), 0, Math.cos(rad), 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t\t/*eslint-enable*/\n\t\t\t]),\n\t\t)\n\t}\n\n\tstatic RotateZ(rad: number): Matrix {\n\t\treturn new Matrix(\n\t\t\tnew Float32Array([\n\t\t\t\t/*eslint-disable*/\n\t\t\t\tMath.cos(rad), -Math.sin(rad), 0, 0,\n\t\t\t\tMath.sin(rad), Math.cos(rad), 0, 0,\n\t\t\t\t0, 0, 1, 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t\t/*eslint-enable*/\n\t\t\t]),\n\t\t)\n\t}\n\n\tstatic Scale(x: number, y: number, z: number): Matrix {\n\t\treturn new Matrix(\n\t\t\tnew Float32Array([\n\t\t\t\t/*eslint-disable*/\n\t\t\t\tx, 0, 0, 0,\n\t\t\t\t0, y, 0, 0,\n\t\t\t\t0, 0, z, 0,\n\t\t\t\t0, 0, 0, 1,\n\t\t\t\t/*eslint-enable*/\n\t\t\t]),\n\t\t)\n\t}\n\n\tMultiply(m: Matrix): Matrix {\n\t\tconst res = new Float32Array(16)\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\tfor (let c = 0; c < 4; c++) {\n\t\t\t\t\tres[i + j * 4] += this.data[c + j * 4] * m.data[i + c * 4]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn new Matrix(res)\n\t}\n\n\tMultiplyVector(v: Vector): Vector {\n\t\treturn {\n\t\t\tx: this.data[0] * v.x + this.data[1] * v.y + this.data[2] * v.z,\n\t\t\ty: this.data[4] * v.x + this.data[5] * v.y + this.data[6] * v.z,\n\t\t\tz: this.data[8] * v.x + this.data[9] * v.y + this.data[10] * v.z,\n\t\t}\n\t}\n\n\tPosition(): Vector {\n\t\treturn {\n\t\t\tx: this.data[3],\n\t\t\ty: this.data[7],\n\t\t\tz: this.data[11],\n\t\t}\n\t}\n\n\tstatic Perspective(fovy: number, aspect: number, near: number, far: number): Matrix {\n\t\tconst c2 = (far + near) / (near - far)\n\t\tconst c1 = (2 * far * near) / (near - far)\n\n\t\tconst s = 1 / Math.tan(fovy / 2)\n\t\tconst m = new Float32Array([\n\t\t\t/*eslint-disable*/\n\t\t\ts / aspect, 0, 0, 0,\n\t\t\t0, s, 0, 0,\n\t\t\t0, 0, c2, c1,\n\t\t\t0, 0, -1, 0,\n\t\t\t/*eslint-enable*/\n\t\t])\n\t\treturn new Matrix(m)\n\t}\n}\n\nexport interface Vector {\n\tx: number\n\ty: number\n\tz: number\n}\n","import { Matrix } from './math'\n\nexport class Position {\n\tmodel: Matrix\n\n\tconstructor() {\n\t\tthis.model = Matrix.Identity()\n\t}\n\tSave(location: Float32Array, offset: number): void {\n\t\tthis.model.Save(location, offset)\n\t}\n\n\tTranslate(x: number, y: number, z: number): void {\n\t\tthis.model = Matrix.Translate(x, y, z).Multiply(this.model)\n\t}\n\n\tRotateX(rad: number): void {\n\t\tthis.model = Matrix.RotateX(rad).Multiply(this.model)\n\t}\n\tRotateXLocal(rad: number): void {\n\t\tconst p = this.model.Position()\n\t\tthis.model = Matrix.Translate(p.x, p.y, p.z)\n\t\t\t.Multiply(Matrix.RotateX(rad))\n\t\t\t.Multiply(Matrix.Translate(-p.x, -p.y, -p.z))\n\t\t\t.Multiply(this.model)\n\t}\n\n\tRotateY(rad: number): void {\n\t\tthis.model = Matrix.RotateY(rad).Multiply(this.model)\n\t}\n\tRotateYLocal(rad: number): void {\n\t\tconst p = this.model.Position()\n\t\tthis.model = Matrix.Translate(p.x, p.y, p.z)\n\t\t\t.Multiply(Matrix.RotateY(rad))\n\t\t\t.Multiply(Matrix.Translate(-p.x, -p.y, -p.z))\n\t\t\t.Multiply(this.model)\n\t}\n\n\tRotateZ(rad: number): void {\n\t\tthis.model = Matrix.RotateZ(rad).Multiply(this.model)\n\t}\n\tRotateZLocal(rad: number): void {\n\t\tconst p = this.model.Position()\n\t\tthis.model = Matrix.Translate(p.x, p.y, p.z)\n\t\t\t.Multiply(Matrix.RotateZ(rad))\n\t\t\t.Multiply(Matrix.Translate(-p.x, -p.y, -p.z))\n\t\t\t.Multiply(this.model)\n\t}\n\n\tScale(x: number, y: number, z: number): void {\n\t\tthis.model = Matrix.Scale(x, y, z).Multiply(this.model)\n\t}\n}\n","import { Matrix } from './math'\nimport * as GPU from './gpu'\n\nexport class Camera {\n\tprivate projection: Matrix\n\tprivate view: Matrix\n\tprivate fov: number\n\n\tconstructor(fieldOfView: number) {\n\t\tthis.projection = Matrix.Perspective(fieldOfView, GPU.global.aspect, 0.1, 1000)\n\t\tthis.view = Matrix.Identity()\n\t\tthis.fov = fieldOfView\n\t}\n\n\tset fieldOfView(val: number) {\n\t\tthis.fov = val\n\t\tthis.projection = Matrix.Perspective(val, GPU.global.aspect, 0.1, 100)\n\t}\n\n\tget fieldOfView(): number {\n\t\treturn this.fov\n\t}\n\n\tBuffer(): GPUBuffer {\n\t\tconst array = new Float32Array(16 * 2)\n\t\tthis.projection.Save(array, 0)\n\t\tthis.view.Save(array, 16)\n\t\treturn GPU.CreateBuffer(array, GPUBufferUsage.UNIFORM)\n\t}\n\n\tUpdateSize(): void {\n\t\tthis.projection = Matrix.Perspective(this.fov, GPU.global.aspect, 1, 1000)\n\t}\n\n\tTranslate(x: number, y: number, z: number): void {\n\t\tthis.view = Matrix.Translate(-x, -y, -z).Multiply(this.view)\n\t}\n\n\tRotateX(rad: number): void {\n\t\tthis.view = Matrix.RotateX(-rad).Multiply(this.view)\n\t}\n\n\tRotateY(rad: number): void {\n\t\tthis.view = Matrix.RotateY(-rad).Multiply(this.view)\n\t}\n\tRotateGlobalY(rad: number): void {\n\t\tconst axis = this.view.MultiplyVector({ x: 0, y: 1, z: 0 })\n\t\tthis.view = Matrix.Rotate(-rad, axis).Multiply(this.view)\n\t}\n\tRotateZ(rad: number): void {\n\t\tthis.view = Matrix.RotateZ(-rad).Multiply(this.view)\n\t}\n}\n","import * as GPU from '../gpu/gpu'\n\nexport function CreateCube(points: number, noise = 0.001): GPUBuffer {\n\tconst vertices = new Float32Array(points * 4)\n\n\tfor (let i = 0; i < points; i++) {\n\t\tswitch (Math.floor(Math.random() * 6)) {\n\t\tcase 0:\n\t\t\tvertices[i * 4 + 0] = Math.random() * 2 - 1\n\t\t\tvertices[i * 4 + 1] = Math.random() * 2 - 1\n\t\t\tvertices[i * 4 + 2] = -1\n\t\t\tbreak\n\t\tcase 1:\n\t\t\tvertices[i * 4 + 0] = Math.random() * 2 - 1\n\t\t\tvertices[i * 4 + 1] = Math.random() * 2 - 1\n\t\t\tvertices[i * 4 + 2] = 1\n\t\t\tbreak\n\t\tcase 2:\n\t\t\tvertices[i * 4 + 0] = Math.random() * 2 - 1\n\t\t\tvertices[i * 4 + 1] = -1\n\t\t\tvertices[i * 4 + 2] = Math.random() * 2 - 1\n\t\t\tbreak\n\t\tcase 3:\n\t\t\tvertices[i * 4 + 0] = Math.random() * 2 - 1\n\t\t\tvertices[i * 4 + 1] = 1\n\t\t\tvertices[i * 4 + 2] = Math.random() * 2 - 1\n\t\t\tbreak\n\t\tcase 4:\n\t\t\tvertices[i * 4 + 0] = -1\n\t\t\tvertices[i * 4 + 1] = Math.random() * 2 - 1\n\t\t\tvertices[i * 4 + 2] = Math.random() * 2 - 1\n\t\t\tbreak\n\t\tcase 5:\n\t\t\tvertices[i * 4 + 0] = 1\n\t\t\tvertices[i * 4 + 1] = Math.random() * 2 - 1\n\t\t\tvertices[i * 4 + 2] = Math.random() * 2 - 1\n\t\t\tbreak\n\t\t}\n\t\tvertices[i * 4 + 0] += noise * Math.random()\n\t\tvertices[i * 4 + 1] += noise * Math.random()\n\t\tvertices[i * 4 + 2] += noise * Math.random()\n\t}\n\treturn GPU.CreateBuffer(vertices, GPUBufferUsage.VERTEX | GPUBufferUsage.STORAGE)\n}\n","import * as GPU from './gpu'\nimport * as Module from './module'\nimport { GetServerFile } from '../helper/file'\nimport { Position } from './position'\n\nlet quadBuffer = undefined as GPUBuffer | undefined\n\nlet pipeline: GPURenderPipeline | undefined = undefined\n\nexport async function Render(\n\tposition: Position,\n\tradius: number,\n\tlength: number,\n\tpositions: GPUBuffer,\n\tcolors: GPUBuffer,\n): Promise<void> {\n\tif (pipeline == undefined || quadBuffer == undefined) {\n\t\tconst src = await GetServerFile('render/cloud.wgsl')\n\t\tconst module = Module.New(src)\n\t\tpipeline = GPU.device.createRenderPipeline({\n\t\t\tvertex: {\n\t\t\t\tmodule: module,\n\t\t\t\tentryPoint: 'vertexMain',\n\t\t\t\tbuffers: [\n\t\t\t\t\t{\n\t\t\t\t\t\tattributes: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshaderLocation: 0,\n\t\t\t\t\t\t\t\toffset: 0 * 4,\n\t\t\t\t\t\t\t\tformat: 'float32x2',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tarrayStride: 2 * 4,\n\t\t\t\t\t\tstepMode: 'vertex',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tattributes: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshaderLocation: 1,\n\t\t\t\t\t\t\t\toffset: 0 * 4,\n\t\t\t\t\t\t\t\tformat: 'float32x3',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tarrayStride: 4 * 4,\n\t\t\t\t\t\tstepMode: 'instance',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tattributes: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshaderLocation: 2,\n\t\t\t\t\t\t\t\toffset: 0 * 4,\n\t\t\t\t\t\t\t\tformat: 'float32x3',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tarrayStride: 4 * 4,\n\t\t\t\t\t\tstepMode: 'instance',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tfragment: {\n\t\t\t\tmodule: module,\n\t\t\t\tentryPoint: 'fragmentMain',\n\t\t\t\ttargets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tformat: GPU.format,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tdepthStencil: {\n\t\t\t\tformat: 'depth32float',\n\t\t\t\tdepthWriteEnabled: true,\n\t\t\t\tdepthCompare: 'less',\n\t\t\t},\n\t\t\tprimitive: {\n\t\t\t\ttopology: 'triangle-strip',\n\t\t\t\tstripIndexFormat: 'uint32',\n\t\t\t\tcullMode: 'back',\n\t\t\t},\n\t\t})\n\t\tquadBuffer = GPU.CreateBuffer(\n\t\t\tnew Float32Array([-1.0, -1.0, 1.0, -1.0, -1.0, 1.0, 1.0, 1.0]),\n\t\t\tGPUBufferUsage.VERTEX,\n\t\t)\n\t}\n\n\tconst array = new Float32Array(16 + 2)\n\tposition.Save(array, 0)\n\tarray[16] = radius\n\tarray[17] = GPU.global.aspect\n\tconst buffer = GPU.CreateBuffer(array, GPUBufferUsage.UNIFORM)\n\tGPU.renderPass.setPipeline(pipeline)\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: pipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: GPU.cameraBuffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t],\n\t})\n\tGPU.renderPass.setBindGroup(0, group)\n\tGPU.renderPass.setVertexBuffer(0, quadBuffer)\n\tGPU.renderPass.setVertexBuffer(1, positions)\n\tGPU.renderPass.setVertexBuffer(2, colors)\n\tGPU.renderPass.draw(4, length)\n}\n","import * as GPU from './gpu'\nimport * as Module from './module'\nimport { GetServerFile } from '../helper/file'\nimport { Position } from './position'\n\nlet computePipeline: undefined | GPUComputePipeline = undefined\nlet renderPipeline: undefined | GPURenderPipeline = undefined\n\nexport async function Compute(k: number, positions: GPUBuffer, length: number): Promise<GPUBuffer> {\n\tif (computePipeline == undefined) {\n\t\tcomputePipeline = GPU.device.createComputePipeline({\n\t\t\tcompute: {\n\t\t\t\tmodule: Module.New(await GetServerFile('compute/kNearest.wgsl')),\n\t\t\t\tentryPoint: 'main',\n\t\t\t},\n\t\t})\n\t}\n\tconst nearest = GPU.CreateEmptyBuffer(\n\t\tlength * 4 * k,\n\t\tGPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC,\n\t)\n\tconst param = new Uint32Array([length, k])\n\tconst buffer = GPU.CreateBuffer(param, GPUBufferUsage.STORAGE)\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: computePipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: positions },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 3,\n\t\t\t\tresource: { buffer: nearest },\n\t\t\t},\n\t\t],\n\t})\n\tconst encoder = GPU.device.createCommandEncoder()\n\tconst compute = encoder.beginComputePass({})\n\tcompute.setPipeline(computePipeline)\n\tcompute.setBindGroup(0, group)\n\tcompute.dispatch(Math.ceil(length / 256))\n\tcompute.endPass()\n\tGPU.device.queue.submit([encoder.finish()])\n\treturn nearest\n}\n\nexport async function Render(\n\tposition: Position,\n\tpositions: GPUBuffer,\n\tcolors: GPUBuffer,\n\tnearest: GPUBuffer,\n\tk: number,\n\tlength: number,\n): Promise<void> {\n\tif (renderPipeline == undefined) {\n\t\tconst src = await GetServerFile('render/kNearest.wgsl')\n\t\tconst module = Module.New(src)\n\t\trenderPipeline = GPU.device.createRenderPipeline({\n\t\t\tvertex: {\n\t\t\t\tmodule: module,\n\t\t\t\tentryPoint: 'vertexMain',\n\t\t\t\tbuffers: [],\n\t\t\t},\n\t\t\tfragment: {\n\t\t\t\tmodule: module,\n\t\t\t\tentryPoint: 'fragmentMain',\n\t\t\t\ttargets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tformat: GPU.format,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tdepthStencil: {\n\t\t\t\tformat: 'depth32float',\n\t\t\t\tdepthWriteEnabled: true,\n\t\t\t\tdepthCompare: 'less',\n\t\t\t},\n\t\t\tprimitive: {\n\t\t\t\ttopology: 'line-list',\n\t\t\t},\n\t\t})\n\t}\n\tconst array = new Float32Array(16 + 1)\n\tposition.Save(array, 0)\n\tnew Uint32Array(array.buffer)[16] = k\n\tconst buffer = GPU.CreateBuffer(array, GPUBufferUsage.UNIFORM)\n\tGPU.renderPass.setPipeline(renderPipeline)\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: renderPipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: GPU.cameraBuffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 2,\n\t\t\t\tresource: { buffer: positions },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 3,\n\t\t\t\tresource: { buffer: colors },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 4,\n\t\t\t\tresource: { buffer: nearest },\n\t\t\t},\n\t\t],\n\t})\n\tGPU.renderPass.setBindGroup(0, group)\n\tGPU.renderPass.draw(length * k * 2)\n}\n","import * as GPU from './gpu'\nimport * as Module from './module'\nimport { GetServerFile } from '../helper/file'\nimport { Position } from './position'\n\nlet computePipeline: undefined | GPUComputePipeline = undefined\nlet renderPipeline: undefined | GPURenderPipeline = undefined\n\nexport const K = 16\n\nexport async function Compute(positions: GPUBuffer, length: number): Promise<GPUBuffer> {\n\tif (computePipeline == undefined) {\n\t\tcomputePipeline = GPU.device.createComputePipeline({\n\t\t\tcompute: {\n\t\t\t\tmodule: Module.New(await GetServerFile('compute/triangulate.wgsl')),\n\t\t\t\tentryPoint: 'main',\n\t\t\t},\n\t\t})\n\t}\n\tconst nearest = GPU.CreateEmptyBuffer(\n\t\tlength * 4 * K,\n\t\tGPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC,\n\t)\n\tconst encoder = GPU.device.createCommandEncoder()\n\tconst param = new Uint32Array([length])\n\tconst buffer = GPU.CreateBuffer(param, GPUBufferUsage.STORAGE)\n\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: computePipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: positions },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 2,\n\t\t\t\tresource: { buffer: nearest },\n\t\t\t},\n\t\t],\n\t})\n\tconst compute = encoder.beginComputePass()\n\tcompute.setPipeline(computePipeline)\n\tcompute.setBindGroup(0, group)\n\tcompute.dispatch(Math.ceil(length / 256))\n\tcompute.endPass()\n\tGPU.device.queue.submit([encoder.finish()])\n\n\treturn nearest\n}\n\nexport async function Render(\n\tposition: Position,\n\tpositions: GPUBuffer,\n\tcolors: GPUBuffer,\n\tnearest: GPUBuffer,\n\tk: number,\n\tlength: number,\n): Promise<void> {\n\tif (renderPipeline == undefined) {\n\t\tconst src = await GetServerFile('render/triangle.wgsl')\n\t\tconst module = Module.New(src)\n\t\trenderPipeline = GPU.device.createRenderPipeline({\n\t\t\tvertex: {\n\t\t\t\tmodule: module,\n\t\t\t\tentryPoint: 'vertexMain',\n\t\t\t\tbuffers: [],\n\t\t\t},\n\t\t\tfragment: {\n\t\t\t\tmodule: module,\n\t\t\t\tentryPoint: 'fragmentMain',\n\t\t\t\ttargets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tformat: GPU.format,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tdepthStencil: {\n\t\t\t\tformat: 'depth32float',\n\t\t\t\tdepthWriteEnabled: true,\n\t\t\t\tdepthCompare: 'less',\n\t\t\t},\n\t\t\tprimitive: {\n\t\t\t\ttopology: 'triangle-list',\n\t\t\t},\n\t\t})\n\t}\n\tconst array = new Float32Array(16 + 1)\n\tposition.Save(array, 0)\n\tnew Uint32Array(array.buffer)[16] = k\n\tconst buffer = GPU.CreateBuffer(array, GPUBufferUsage.UNIFORM)\n\tGPU.renderPass.setPipeline(renderPipeline)\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: renderPipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: GPU.cameraBuffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 2,\n\t\t\t\tresource: { buffer: positions },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 3,\n\t\t\t\tresource: { buffer: colors },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 4,\n\t\t\t\tresource: { buffer: nearest },\n\t\t\t},\n\t\t],\n\t})\n\tGPU.renderPass.setBindGroup(0, group)\n\tGPU.renderPass.draw(length * k * 3)\n}\n","import * as GPU from './gpu'\nimport * as Module from './module'\nimport { GetServerFile } from '../helper/file'\n\nlet computePipeline: undefined | GPUComputePipeline = undefined\n\nexport async function Compute(nearest: GPUBuffer, k: number, length: number): Promise<void> {\n\tif (computePipeline == undefined) {\n\t\tcomputePipeline = GPU.device.createComputePipeline({\n\t\t\tcompute: {\n\t\t\t\tmodule: Module.New(await GetServerFile('compute/filter.wgsl')),\n\t\t\t\tentryPoint: 'main',\n\t\t\t},\n\t\t})\n\t}\n\tconst param = new Uint32Array([length, k])\n\tconst buffer = GPU.CreateBuffer(param, GPUBufferUsage.STORAGE)\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: computePipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: nearest },\n\t\t\t},\n\t\t],\n\t})\n\tconst encoder = GPU.device.createCommandEncoder()\n\tconst compute = encoder.beginComputePass({})\n\tcompute.setPipeline(computePipeline)\n\tcompute.setBindGroup(0, group)\n\tcompute.dispatch(Math.ceil(length / 256))\n\tcompute.endPass()\n\tGPU.device.queue.submit([encoder.finish()])\n}\n","import * as GPU from './gpu'\nimport * as Module from './module'\nimport { GetServerFile } from '../helper/file'\n\nlet computePipeline: undefined | GPUComputePipeline = undefined\n\nexport async function Compute(\n\tcloud: GPUBuffer,\n\tnearest: GPUBuffer,\n\tcolors: GPUBuffer,\n\tk: number,\n\tlength: number,\n): Promise<void> {\n\tif (computePipeline == undefined) {\n\t\tcomputePipeline = GPU.device.createComputePipeline({\n\t\t\tcompute: {\n\t\t\t\tmodule: Module.New(await GetServerFile('compute/edge.wgsl')),\n\t\t\t\tentryPoint: 'main',\n\t\t\t},\n\t\t})\n\t}\n\tconst param = new Uint32Array([length, k])\n\tconst buffer = GPU.CreateBuffer(param, GPUBufferUsage.STORAGE)\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: computePipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: cloud },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 2,\n\t\t\t\tresource: { buffer: nearest },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 3,\n\t\t\t\tresource: { buffer: colors },\n\t\t\t},\n\t\t],\n\t})\n\tconst encoder = GPU.device.createCommandEncoder()\n\tconst compute = encoder.beginComputePass({})\n\tcompute.setPipeline(computePipeline)\n\tcompute.setBindGroup(0, group)\n\tcompute.dispatch(Math.ceil(length / 256))\n\tcompute.endPass()\n\tGPU.device.queue.submit([encoder.finish()])\n}\n","import * as GPU from './gpu'\nimport * as Module from './module'\nimport { GetServerFile } from '../helper/file'\n\nlet computePipeline: undefined | GPUComputePipeline = undefined\n\nexport async function Compute(\n\tcloud: GPUBuffer,\n\tnearest: GPUBuffer,\n\tcolors: GPUBuffer,\n\tk: number,\n\tlength: number,\n): Promise<void> {\n\tif (computePipeline == undefined) {\n\t\tcomputePipeline = GPU.device.createComputePipeline({\n\t\t\tcompute: {\n\t\t\t\tmodule: Module.New(await GetServerFile('compute/edgeOld.wgsl')),\n\t\t\t\tentryPoint: 'main',\n\t\t\t},\n\t\t})\n\t}\n\tconst param = new Uint32Array([length, k])\n\tconst buffer = GPU.CreateBuffer(param, GPUBufferUsage.STORAGE)\n\tconst group = GPU.device.createBindGroup({\n\t\tlayout: computePipeline.getBindGroupLayout(0),\n\t\tentries: [\n\t\t\t{\n\t\t\t\tbinding: 0,\n\t\t\t\tresource: { buffer: buffer },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 1,\n\t\t\t\tresource: { buffer: cloud },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 2,\n\t\t\t\tresource: { buffer: nearest },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbinding: 3,\n\t\t\t\tresource: { buffer: colors },\n\t\t\t},\n\t\t],\n\t})\n\tconst encoder = GPU.device.createCommandEncoder()\n\tconst compute = encoder.beginComputePass({})\n\tcompute.setPipeline(computePipeline)\n\tcompute.setBindGroup(0, group)\n\tcompute.dispatch(Math.ceil(length / 256))\n\tcompute.endPass()\n\tGPU.device.queue.submit([encoder.finish()])\n}\n","import * as GPU from '../gpu/gpu'\n\nexport function CreateColors(points: number): GPUBuffer {\n\tconst colors = new Float32Array(points * 4)\n\n\tfor (let i = 0; i < points; i++) {\n\t\tcolors[i * 4 + 0] = 0.3 + 0.7 * Math.random()\n\t\tcolors[i * 4 + 1] = 0.3 + 0.7 * Math.random()\n\t\tcolors[i * 4 + 2] = 0.3 + 0.7 * Math.random()\n\t}\n\n\treturn GPU.CreateBuffer(colors, GPUBufferUsage.VERTEX | GPUBufferUsage.STORAGE)\n}\n","import * as GPU from '../gpu/gpu'\n\nexport function CreateGrid(amount: number): {\n\tlength: number\n\tpositions: GPUBuffer\n\tcolors: GPUBuffer\n} {\n\tconst positions = new Float32Array((amount * 4 + 3) * 8)\n\tconst colors = new Float32Array((amount * 4 + 3) * 8)\n\ttype vec = { x: number; y: number; z: number }\n\tconst addLine = (\n\t\tidx: number,\n\t\tstart: vec,\n\t\tend: vec,\n\t\tcolor: vec,\n\t\tendColor: vec | undefined = undefined,\n\t) => {\n\t\tif (endColor == undefined) {\n\t\t\tendColor = color\n\t\t}\n\t\tidx *= 8\n\t\tpositions[idx + 0] = start.x\n\t\tpositions[idx + 1] = start.y\n\t\tpositions[idx + 2] = start.z\n\t\tcolors[idx + 0] = color.x\n\t\tcolors[idx + 1] = color.y\n\t\tcolors[idx + 2] = color.z\n\n\t\tpositions[idx + 4] = end.x\n\t\tpositions[idx + 5] = end.y\n\t\tpositions[idx + 6] = end.z\n\t\tcolors[idx + 4] = endColor.x\n\t\tcolors[idx + 5] = endColor.y\n\t\tcolors[idx + 6] = endColor.z\n\t}\n\tfor (let i = -amount; i <= amount; i++) {\n\t\tif (i == 0) {\n\t\t\tcontinue\n\t\t}\n\t\tlet idx: number\n\t\tif (i < 0) {\n\t\t\tidx = i\n\t\t} else if (i == 0) {\n\t\t\tcontinue\n\t\t} else {\n\t\t\tidx = i - 1\n\t\t}\n\t\taddLine(\n\t\t\tamount * 1 + idx,\n\t\t\t{ x: i, y: 0, z: amount },\n\t\t\t{ x: i, y: 0, z: -amount },\n\t\t\t{ x: 1, y: 1, z: 1 },\n\t\t)\n\t\taddLine(\n\t\t\tamount * 3 + idx,\n\t\t\t{ x: amount, y: 0, z: i },\n\t\t\t{ x: -amount, y: 0, z: i },\n\t\t\t{ x: 1, y: 1, z: 1 },\n\t\t)\n\t}\n\t//3 main axes\n\taddLine(\n\t\tamount * 4 + 0,\n\t\t{ x: -amount, y: 0, z: 0 },\n\t\t{ x: amount, y: 0, z: 0 },\n\t\t{ x: 1, y: 1, z: 1 },\n\t\t{ x: 1, y: 0, z: 0 },\n\t)\n\taddLine(\n\t\tamount * 4 + 1,\n\t\t{ x: 0, y: -amount, z: 0 },\n\t\t{ x: 0, y: amount, z: 0 },\n\t\t{ x: 1, y: 1, z: 1 },\n\t\t{ x: 0, y: 1, z: 0 },\n\t)\n\taddLine(\n\t\tamount * 4 + 2,\n\t\t{ x: 0, y: 0, z: -amount },\n\t\t{ x: 0, y: 0, z: amount },\n\t\t{ x: 1, y: 1, z: 1 },\n\t\t{ x: 0, y: 0, z: 1 },\n\t)\n\treturn {\n\t\tlength: (amount * 4 + 3) * 2,\n\t\tpositions: GPU.CreateBuffer(positions, GPUBufferUsage.VERTEX | GPUBufferUsage.STORAGE),\n\t\tcolors: GPU.CreateBuffer(colors, GPUBufferUsage.VERTEX | GPUBufferUsage.STORAGE),\n\t}\n}\n","import * as GPU from '../gpu/gpu'\n\nexport function CreateSphere(points: number): GPUBuffer {\n\tconst vertices = new Float32Array(points * 4)\n\n\tfor (let i = 0; i < points; i++) {\n\t\tconst long = Math.acos(Math.random() * 2 - 1) //less points near the poles\n\t\tconst lat = Math.random() * 2 * Math.PI\n\n\t\tvertices[i * 4 + 0] = Math.sin(lat) * Math.sin(long)\n\t\tvertices[i * 4 + 1] = Math.cos(long)\n\t\tvertices[i * 4 + 2] = Math.cos(lat) * Math.sin(long)\n\t}\n\n\treturn GPU.CreateBuffer(vertices, GPUBufferUsage.VERTEX | GPUBufferUsage.STORAGE)\n}\n","//https://gitlab.com/taketwo/three-pcd-loader/-/blob/master/decompress-lzf.js //edited\nexport function LZF(inData: Uint8Array, outLength: number): Uint8Array {\n\tconst inLength = inData.length\n\tconst outData = new Uint8Array(outLength)\n\tlet inPtr = 0\n\tlet outPtr = 0\n\tdo {\n\t\tlet ctrl = inData[inPtr++]\n\t\tif (ctrl < 1 << 5) {\n\t\t\tctrl++\n\t\t\tif (outPtr + ctrl > outLength) throw new Error('Output buffer is not large enough')\n\t\t\tif (inPtr + ctrl > inLength) throw new Error('Invalid compressed data')\n\t\t\tdo {\n\t\t\t\toutData[outPtr++] = inData[inPtr++]\n\t\t\t} while (--ctrl)\n\t\t} else {\n\t\t\tlet len = ctrl >> 5\n\t\t\tlet ref = outPtr - ((ctrl & 0x1f) << 8) - 1\n\t\t\tif (inPtr >= inLength) throw new Error('Invalid compressed data')\n\t\t\tif (len === 7) {\n\t\t\t\tlen += inData[inPtr++]\n\t\t\t\tif (inPtr >= inLength) throw new Error('Invalid compressed data')\n\t\t\t}\n\t\t\tref -= inData[inPtr++]\n\t\t\tif (outPtr + len + 2 > outLength) throw new Error('Output buffer is not large enough')\n\t\t\tif (ref < 0) throw new Error('Invalid compressed data')\n\t\t\tif (ref >= outPtr) throw new Error('Invalid compressed data')\n\t\t\tdo {\n\t\t\t\toutData[outPtr++] = outData[ref++]\n\t\t\t} while (--len + 2)\n\t\t}\n\t} while (inPtr < inLength)\n\treturn outData\n}\n","//https://gitlab.com/taketwo/three-pcd-loader/-/blob/master/pcd-loader.js //edited\nimport * as Decompress from './decompress'\nimport * as GPU from '../gpu/gpu'\n\n/**\n * @author Filipe Caixeta / http://filipecaixeta.com.br\n * @author Sergey Alexandrov\n *\n * Description: A THREE loader for PCD files.\n *\n * Based on the example THREE.PCDLoader written by Filipe Caixeta.\n *\n * Changes:\n *\n *   - added support for compressed binary files\n *   - significantly improved header parsing time\n *   - added support for RGBA color field\n *   - removed support for normals field\n *\n */\n\nconst littleEndian = true\n\nexport function CreatePCD(data: ArrayBufferLike): [GPUBuffer, number] | undefined {\n\tconst header = parseHeader(data)\n\tif (header == null) {\n\t\treturn undefined\n\t}\n\tconst offset = header.offset\n\tlet position: Float32Array | undefined = undefined\n\tif (offset.x !== undefined && offset.y !== undefined && offset.z !== undefined) {\n\t\tposition = new Float32Array(header.points * 4)\n\t}\n\n\tlet color: Float32Array | undefined = undefined\n\tlet color_offset: number = undefined as any\n\tif (offset.rgb !== undefined || offset.rgba !== undefined) {\n\t\tcolor = new Float32Array(header.points * 4)\n\t\tcolor_offset = offset.rgb === undefined ? offset.rgba : offset.rgb\n\t}\n\n\tif (header.data === 'ascii') {\n\t\tconst charArrayView = new Uint8Array(data)\n\t\tlet dataString = ''\n\t\tfor (let j = header.headerLen; j < data.byteLength; j++) {\n\t\t\tdataString += String.fromCharCode(charArrayView[j])\n\t\t}\n\n\t\tconst lines = dataString.split('\\n')\n\t\tlet i3 = 0\n\t\tfor (let i = 0; i < lines.length; i++, i3 += 4) {\n\t\t\tconst line = lines[i].split(' ')\n\t\t\tif (position !== undefined) {\n\t\t\t\tposition[i3 + 0] = parseFloat(line[offset.x])\n\t\t\t\tposition[i3 + 1] = parseFloat(line[offset.y])\n\t\t\t\tposition[i3 + 2] = parseFloat(line[offset.z])\n\t\t\t}\n\t\t\tif (color !== undefined) {\n\t\t\t\tlet c: Uint32Array | Float32Array = undefined as any\n\t\t\t\tif (offset.rgba !== undefined) {\n\t\t\t\t\tc = new Uint32Array([parseInt(line[offset.rgba])])\n\t\t\t\t} else if (offset.rgb !== undefined) {\n\t\t\t\t\tc = new Float32Array([parseFloat(line[offset.rgb])])\n\t\t\t\t}\n\t\t\t\tconst dataview = new Uint8Array(c.buffer, 0)\n\t\t\t\tcolor[i3 + 2] = dataview[0] / 255.0\n\t\t\t\tcolor[i3 + 1] = dataview[1] / 255.0\n\t\t\t\tcolor[i3 + 0] = dataview[2] / 255.0\n\t\t\t}\n\t\t}\n\t} else if (header.data === 'binary') {\n\t\tlet row = 0\n\t\tconst dataArrayView = new DataView(data, header.headerLen)\n\t\tfor (let p = 0; p < header.points; row += header.rowSize, p++) {\n\t\t\tif (position !== undefined) {\n\t\t\t\tposition[p * 4 + 0] = dataArrayView.getFloat32(row + offset.x, littleEndian)\n\t\t\t\tposition[p * 4 + 1] = dataArrayView.getFloat32(row + offset.y, littleEndian)\n\t\t\t\tposition[p * 4 + 2] = dataArrayView.getFloat32(row + offset.z, littleEndian)\n\t\t\t}\n\t\t\tif (color !== undefined) {\n\t\t\t\tcolor[p * 4 + 2] = dataArrayView.getUint8(row + color_offset + 0) / 255.0\n\t\t\t\tcolor[p * 4 + 1] = dataArrayView.getUint8(row + color_offset + 1) / 255.0\n\t\t\t\tcolor[p * 4 + 0] = dataArrayView.getUint8(row + color_offset + 2) / 255.0\n\t\t\t}\n\t\t}\n\t} else if (header.data === 'binary_compressed') {\n\t\tconst sizes = new Uint32Array(data.slice(header.headerLen, header.headerLen + 8))\n\t\tconst compressedSize = sizes[0]\n\t\tconst decompressedSize = sizes[1]\n\t\tconst decompressed = Decompress.LZF(\n\t\t\tnew Uint8Array(data, header.headerLen + 8, compressedSize),\n\t\t\tdecompressedSize,\n\t\t)\n\t\tconst dataArrayView = new DataView(decompressed.buffer)\n\t\tfor (let p = 0; p < header.points; p++) {\n\t\t\tif (position !== undefined) {\n\t\t\t\tposition[p * 4 + 0] = dataArrayView.getFloat32(offset.x + p * 4, littleEndian)\n\t\t\t\tposition[p * 4 + 1] = dataArrayView.getFloat32(offset.y + p * 4, littleEndian)\n\t\t\t\tposition[p * 4 + 2] = dataArrayView.getFloat32(offset.z + p * 4, littleEndian)\n\t\t\t}\n\t\t\tif (color !== undefined) {\n\t\t\t\tcolor[p * 4 + 2] = dataArrayView.getUint8(color_offset + p * 4 + 0) / 255.0\n\t\t\t\tcolor[p * 4 + 1] = dataArrayView.getUint8(color_offset + p * 4 + 1) / 255.0\n\t\t\t\tcolor[p * 4 + 0] = dataArrayView.getUint8(color_offset + p * 4 + 2) / 255.0\n\t\t\t}\n\t\t}\n\t}\n\tif (position == undefined) {\n\t\treturn undefined\n\t}\n\treturn [\n\t\tGPU.CreateBuffer(position, GPUBufferUsage.VERTEX | GPUBufferUsage.STORAGE),\n\t\theader.points,\n\t]\n}\n\ntype Header = {\n\tdata: string\n\theaderLen: number\n\tstr: string\n\tversion: number\n\tfields: string[]\n\tsize: number[]\n\ttype: string[]\n\tcount: number[]\n\twidth: number\n\theight: number\n\tviewpoint: string\n\tpoints: number\n\toffset: { [key: string]: number }\n\trowSize: number\n}\n\nfunction parseHeader(binaryData: ArrayBufferLike): Header | null {\n\tlet headerText = ''\n\tconst charArray = new Uint8Array(binaryData)\n\tlet i = 0\n\tconst max = charArray.length\n\twhile (i < max && headerText.search(/[\\r\\n]DATA\\s(\\S*)\\s/i) === -1) {\n\t\theaderText += String.fromCharCode(charArray[i++])\n\t}\n\tconst result1 = headerText.search(/[\\r\\n]DATA\\s(\\S*)\\s/i)\n\tconst result2 = /[\\r\\n]DATA\\s(\\S*)\\s/i.exec(headerText.substr(result1 - 1))\n\tif (result1 == undefined || result2 == undefined) {\n\t\treturn null\n\t}\n\n\tconst header = {} as Header\n\theader.data = result2[1]\n\theader.headerLen = result2[0].length + result1\n\theader.str = headerText.substr(0, header.headerLen)\n\n\t// Remove comments\n\theader.str = header.str.replace(/#.*/gi, '')\n\tconst version = /VERSION (.*)/i.exec(header.str)\n\tif (version !== null) {\n\t\theader.version = parseFloat(version[1])\n\t}\n\tconst fields = /FIELDS (.*)/i.exec(header.str)\n\tif (fields !== null) {\n\t\theader.fields = fields[1].split(' ')\n\t}\n\tconst size = /SIZE (.*)/i.exec(header.str)\n\tif (size !== null) {\n\t\theader.size = size[1].split(' ').map(function (x) {\n\t\t\treturn parseInt(x, 10)\n\t\t})\n\t}\n\tconst type = /TYPE (.*)/i.exec(header.str)\n\tif (type !== null) {\n\t\theader.type = type[1].split(' ')\n\t}\n\tconst count = /COUNT (.*)/i.exec(header.str)\n\tif (count !== null) {\n\t\theader.count = count[1].split(' ').map(function (x) {\n\t\t\treturn parseInt(x, 10)\n\t\t})\n\t}\n\tconst width = /WIDTH (.*)/i.exec(header.str)\n\tif (width !== null) {\n\t\theader.width = parseInt(width[1])\n\t}\n\tconst height = /HEIGHT (.*)/i.exec(header.str)\n\tif (height !== null) {\n\t\theader.height = parseInt(height[1])\n\t}\n\tconst viewpoint = /VIEWPOINT (.*)/i.exec(header.str)\n\tif (viewpoint !== null) {\n\t\theader.viewpoint = viewpoint[1]\n\t}\n\tconst points = /POINTS (.*)/i.exec(header.str)\n\tif (points !== null) {\n\t\theader.points = parseInt(points[1], 10)\n\t}\n\tif (header.points === null) {\n\t\theader.points = header.width * header.height\n\t}\n\tif (header.count == undefined) {\n\t\theader.count = []\n\t\tfor (i = 0; i < header.fields.length; i++) {\n\t\t\theader.count.push(1)\n\t\t}\n\t}\n\theader.offset = {}\n\tlet sizeSum = 0\n\tfor (let j = 0; j < header.fields.length; j++) {\n\t\tif (header.data === 'ascii') {\n\t\t\theader.offset[header.fields[j]] = j\n\t\t} else if (header.data === 'binary') {\n\t\t\theader.offset[header.fields[j]] = sizeSum\n\t\t\tsizeSum += header.size[j]\n\t\t} else if (header.data === 'binary_compressed') {\n\t\t\theader.offset[header.fields[j]] = sizeSum\n\t\t\tsizeSum += header.size[j] * header.points\n\t\t}\n\t}\n\t// For binary only\n\theader.rowSize = sizeSum\n\treturn header\n}\n","import * as GPU from './gpu/gpu'\nimport * as Lines from './gpu/lines'\nimport { Position } from './gpu/position'\nimport { Camera } from './gpu/camera'\nimport { CreateCube } from './loader/cube'\nimport * as Cloud from './gpu/cloud'\nimport * as KNearest from './gpu/kNearest'\nimport * as Triangulate from './gpu/triangulate'\nimport * as Filter from './gpu/filter'\nimport * as Edge from './gpu/edge'\nimport * as EdgeOld from './gpu/edgeOld'\nimport { CreateColors } from './loader/color'\nimport { CreateGrid } from './loader/grid'\nimport { CreateSphere } from './loader/sphere'\nimport { CreatePCD } from './loader/pcd'\n\ndocument.body.onload = async () => {\n\tconst display = document.getElementById('display') as HTMLDivElement\n\tconst canvas = await GPU.Setup(display.clientWidth, display.clientHeight)\n\tif (canvas == undefined) {\n\t\tdisplay.remove()\n\t\tconst error = document.createElement('div')\n\t\terror.className = 'error'\n\t\tconst topLine = document.createElement('div')\n\t\ttopLine.className = 'large'\n\t\ttopLine.innerHTML = 'WebGPU not available'\n\t\terror.append(topLine)\n\t\tconst botLine = document.createElement('div')\n\t\tbotLine.className = 'normal'\n\t\tbotLine.innerHTML =\n\t\t\t'Only tested with <a href=\"https://www.google.com/chrome\">Google Chrome</a>'\n\t\terror.append(botLine)\n\t\tdocument.body.append(error)\n\t\treturn\n\t}\n\tdisplay.append(canvas)\n\n\tconst cam = new Camera(Math.PI / 4)\n\tcam.Translate(0, 5, 30)\n\n\tconst increase = new Position()\n\tincrease.Scale(5, 5, 5)\n\tconst normal = new Position()\n\n\tlet k = 64\n\tlet kOld = k\n\tlet length = 50_000\n\tlet lengthOld = length\n\tlet form: 'cube' | 'sphere' | 'bunny' | 'test' = 'sphere'\n\tlet cloud = CreateSphere(length)\n\tlet colors = CreateColors(length)\n\n\tconst grid = CreateGrid(10)\n\n\tdisplay.onwheel = (ev) => {\n\t\tconst scale = 1 + ev.deltaY / 1000\n\t\tif (ev.ctrlKey == false) {\n\t\t\tincrease.Scale(scale, scale, scale)\n\t\t} else {\n\t\t\tlet fov = cam.fieldOfView * scale\n\t\t\tif (fov < Math.PI / 10) {\n\t\t\t\tfov = Math.PI / 10\n\t\t\t}\n\t\t\tif (fov > (Math.PI * 9) / 10) {\n\t\t\t\tfov = (Math.PI * 9) / 10\n\t\t\t}\n\t\t\tcam.fieldOfView = fov\n\t\t}\n\t\tev.preventDefault()\n\t\tev.stopImmediatePropagation()\n\t}\n\n\tdocument.body.onresize = () => {\n\t\tGPU.Resize(display.clientWidth, display.clientHeight)\n\t\tcam.UpdateSize()\n\t}\n\n\tconst keys: { [key: string]: true | undefined } = {}\n\tlet nearest: undefined | GPUBuffer = undefined\n\tdocument.body.onkeydown = async (ev) => {\n\t\tkeys[ev.code] = true\n\t\tswitch (ev.code) {\n\t\tcase 'KeyH':\n\t\t\tmakeHint(\n\t\t\t\t'Left mouse button: rotate camera',\n\t\t\t\t'Mouse wheel: change cloud size',\n\t\t\t\t'Mouse wheel + Control: change field of view',\n\t\t\t\t'QWER: move camera',\n\t\t\t\t'1: change cloud form',\n\t\t\t\t'1 + Control: change cloud size for sphere and cube',\n\t\t\t\t'2: compute k nearest points',\n\t\t\t\t'2 + Control: change k',\n\t\t\t\t'3: compute triangulation',\n\t\t\t\t'4: approximate normal (best with triangulation)',\n\t\t\t\t'4 + Control: approximate normal (best with k-nearest)',\n\t\t\t\t'Space: render connections with polygons',\n\t\t\t\t'0: open notes (german)',\n\t\t\t)\n\t\t\tbreak\n\t\tcase 'Digit1':\n\t\t\tif (ev.ctrlKey) {\n\t\t\t\tconst number = getUserNumber('input new cloud size')\n\t\t\t\tif (number != undefined) {\n\t\t\t\t\tlengthOld = number\n\t\t\t\t\tform = 'test'\n\t\t\t\t} else {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t\tcloud.destroy()\n\t\t\tcolors.destroy()\n\t\t\tswitch (form) {\n\t\t\tcase 'sphere':\n\t\t\t\tlength = lengthOld\n\t\t\t\tcloud = CreateCube(length)\n\t\t\t\tform = 'cube'\n\t\t\t\tbreak\n\t\t\tcase 'cube': {\n\t\t\t\tconst response = await fetch('../src/loader/pcd/bunny.pcd')\n\t\t\t\tconst content = await (await response.blob()).arrayBuffer()\n\t\t\t\tconst result = CreatePCD(content)\n\t\t\t\tif (result != undefined) {\n\t\t\t\t\t[cloud, length] = result\n\t\t\t\t} else {\n\t\t\t\t\talert('pcd error')\n\t\t\t\t}\n\t\t\t\tform = 'bunny'\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'bunny': {\n\t\t\t\tconst response = await fetch('../src/loader/pcd/rops_cloud.pcd')\n\t\t\t\tconst content = await (await response.blob()).arrayBuffer()\n\t\t\t\tconst result = CreatePCD(content)\n\t\t\t\tif (result != undefined) {\n\t\t\t\t\t[cloud, length] = result\n\t\t\t\t} else {\n\t\t\t\t\talert('pcd error')\n\t\t\t\t}\n\t\t\t\tform = 'test'\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'test':\n\t\t\t\tlength = lengthOld\n\t\t\t\tcloud = CreateSphere(length)\n\t\t\t\tform = 'sphere'\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcolors = CreateColors(length)\n\t\t\tif (nearest != undefined) {\n\t\t\t\tnearest.destroy()\n\t\t\t\tnearest = undefined\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'Digit2':\n\t\t\tif (ev.ctrlKey) {\n\t\t\t\tconst number = getUserNumber('input new k for nearest points')\n\t\t\t\tif (number != undefined) {\n\t\t\t\t\tkOld = number\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (nearest != undefined) {\n\t\t\t\tnearest.destroy()\n\t\t\t}\n\t\t\tk = kOld\n\t\t\tnearest = await KNearest.Compute(k, cloud, length)\n\t\t\tbreak\n\t\tcase 'Digit3':\n\t\t\tif (nearest != undefined) {\n\t\t\t\tnearest.destroy()\n\t\t\t}\n\t\t\tnearest = await Triangulate.Compute(cloud, length)\n\t\t\tk = Triangulate.K\n\t\t\tbreak\n\t\tcase 'Digit4':\n\t\t\tif (nearest == undefined) {\n\t\t\t\talert('please calculate the connections first')\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tif (ev.ctrlKey == false) {\n\t\t\t\tawait Edge.Compute(cloud, nearest, colors, k, length)\n\t\t\t} else {\n\t\t\t\tawait EdgeOld.Compute(cloud, nearest, colors, k, length)\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'Digit5':\n\t\t\tif (nearest == undefined) {\n\t\t\t\talert('please calculate the connections first')\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tawait Filter.Compute(nearest, k, length)\n\t\t\tbreak\n\t\tcase 'Digit0':\n\t\t\twindow.open('notes.html', '_blank')\n\t\t}\n\t}\n\n\tdocument.body.onkeyup = (ev) => {\n\t\tdelete keys[ev.code]\n\t}\n\tmakeHint('press \\'H\\' for help')\n\n\tdisplay.onmousemove = (ev) => {\n\t\tif ((ev.buttons & 1) != 0) {\n\t\t\tcam.RotateX(-ev.movementY / 200)\n\t\t\tcam.RotateGlobalY(-ev.movementX / 200)\n\t\t}\n\t}\n\n\tlet last: number\n\trequestAnimationFrame((time: number) => {\n\t\tlast = time\n\t})\n\n\tasync function Draw(time: number) {\n\t\tconst delta = time - last\n\t\tif (delta > 25) {\n\t\t\tconsole.log(delta)\n\t\t}\n\t\tconst dist = delta / 50\n\t\tconst move = (key: string, x: number, y: number, z: number) => {\n\t\t\tif (keys[key] != undefined) {\n\t\t\t\tcam.Translate(x * dist, y * dist, z * dist)\n\t\t\t}\n\t\t}\n\n\t\tmove('KeyW', 0, 0, -1)\n\t\tmove('KeyD', 1, 0, 0)\n\t\tmove('KeyS', 0, 0, 1)\n\t\tmove('KeyA', -1, 0, 0)\n\t\tmove('KeyF', 0, -1, 0)\n\t\tmove('KeyR', 0, 1, 0)\n\n\t\tGPU.StartRender(cam)\n\t\tawait Lines.Render(normal, grid.length, grid.positions, grid.colors)\n\t\tif (nearest != undefined) {\n\t\t\tif (keys['Space'] == undefined) {\n\t\t\t\tawait Cloud.Render(increase, 0.015, length, cloud, colors)\n\t\t\t\tawait KNearest.Render(increase, cloud, colors, nearest, k, length)\n\t\t\t} else {\n\t\t\t\tawait Triangulate.Render(increase, cloud, colors, nearest, k, length)\n\t\t\t}\n\t\t} else {\n\t\t\tawait Cloud.Render(increase, 0.015, length, cloud, colors)\n\t\t}\n\t\tGPU.FinishRender()\n\t\tlast = time\n\t\trequestAnimationFrame(Draw)\n\t}\n\trequestAnimationFrame(Draw)\n}\n\nfunction makeHint(...text: string[]): void {\n\tconst hint = document.createElement('div')\n\tlet combined = ''\n\tfor (let i = 0; i < text.length; i++) {\n\t\tcombined += text[i] + '\\n'\n\t}\n\thint.textContent = combined\n\thint.className = 'hint'\n\tdocument.body.append(hint)\n\tsetTimeout(() => {\n\t\thint.remove()\n\t}, 5000)\n}\n\nfunction getUserNumber(text: string): number | undefined {\n\tconst str = prompt(text)\n\tif (str == null) {\n\t\treturn undefined\n\t}\n\tconst x = parseInt(str)\n\tif (isNaN(x)) {\n\t\treturn undefined\n\t}\n\treturn x\n}\n"]}